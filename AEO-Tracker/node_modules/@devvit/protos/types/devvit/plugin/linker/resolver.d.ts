/**
 * #resolver.ts
 *
 * @packageDocumentation
 */
import { Metadata, MethodDefinition } from "@lib/Types.js";
import _m0 from 'protobufjs/minimal.js';
import { Empty } from '../../../google/protobuf/empty.js';
import { PackageQuery } from '../../runtime/bundle.js';
import { Bundle } from '../buildpack/buildpack_common.js';
import { InspectorDescription, InspectorDescriptions } from '../inspector/inspector.js';
/** A PackageQuery resolves to a package backed by a Bundle or a plugin. */
export interface Resolution {
    bundle?: Bundle | undefined;
    error?: ResolutionError | undefined;
    plugin?: InspectorDescription | undefined;
}
export interface ResolutionError {
    /** Failing query. */
    query?: PackageQuery;
    /** Human readable error message. */
    text: string;
}
export declare const Resolution: {
    $type: "devvit.plugin.linker.Resolution";
    encode(message: Resolution, writer?: _m0.Writer): _m0.Writer;
    decode(input: _m0.Reader | Uint8Array, length?: number): Resolution;
    fromJSON(object: any): Resolution;
    toJSON(message: Resolution): unknown;
    fromPartial<I extends {
        bundle?: {
            code?: string | undefined;
            dependencies?: {
                actor?: {
                    name?: string | undefined;
                    owner?: string | undefined;
                    version?: string | undefined;
                } | undefined;
                hostname?: string | undefined;
                provides?: {
                    actor?: {
                        name?: string | undefined;
                        owner?: string | undefined;
                        version?: string | undefined;
                    } | undefined;
                    definition?: {
                        fullName?: string | undefined;
                        methods?: {
                            fullName?: string | undefined;
                            name?: string | undefined;
                            requestStream?: boolean | undefined;
                            responseStream?: boolean | undefined;
                            requestType?: string | undefined;
                            responseType?: string | undefined;
                        }[] | undefined;
                        name?: string | undefined;
                        version?: string | undefined;
                    } | undefined;
                    locations?: {
                        allow?: string[] | undefined;
                        deny?: string[] | undefined;
                    } | undefined;
                    partitionsBy?: string[] | undefined;
                }[] | undefined;
                uses?: {
                    name?: string | undefined;
                    owner?: string | undefined;
                    typeName?: string | undefined;
                    versions?: string | undefined;
                }[] | undefined;
            } | undefined;
            buildInfo?: {
                created?: Date | undefined;
                dependencies?: {
                    [x: string]: string | undefined;
                } | undefined;
            } | undefined;
            assets?: {
                files?: {
                    path?: string | undefined;
                    content?: string | undefined;
                    isDirectory?: boolean | undefined;
                    isBase64?: boolean | undefined;
                }[] | undefined;
            } | undefined;
            assetIds?: {
                [x: string]: string | undefined;
            } | undefined;
        } | undefined;
        error?: {
            query?: {
                name?: string | undefined;
                owner?: string | undefined;
                typeName?: string | undefined;
                versions?: string | undefined;
            } | undefined;
            text?: string | undefined;
        } | undefined;
        plugin?: {
            provides?: {
                fullName?: string | undefined;
                methods?: {
                    fullName?: string | undefined;
                    name?: string | undefined;
                    requestStream?: boolean | undefined;
                    responseStream?: boolean | undefined;
                    requestType?: string | undefined;
                    responseType?: string | undefined;
                }[] | undefined;
                name?: string | undefined;
                version?: string | undefined;
            }[] | undefined;
            hostname?: string | undefined;
        } | undefined;
    } & {
        bundle?: ({
            code?: string | undefined;
            dependencies?: {
                actor?: {
                    name?: string | undefined;
                    owner?: string | undefined;
                    version?: string | undefined;
                } | undefined;
                hostname?: string | undefined;
                provides?: {
                    actor?: {
                        name?: string | undefined;
                        owner?: string | undefined;
                        version?: string | undefined;
                    } | undefined;
                    definition?: {
                        fullName?: string | undefined;
                        methods?: {
                            fullName?: string | undefined;
                            name?: string | undefined;
                            requestStream?: boolean | undefined;
                            responseStream?: boolean | undefined;
                            requestType?: string | undefined;
                            responseType?: string | undefined;
                        }[] | undefined;
                        name?: string | undefined;
                        version?: string | undefined;
                    } | undefined;
                    locations?: {
                        allow?: string[] | undefined;
                        deny?: string[] | undefined;
                    } | undefined;
                    partitionsBy?: string[] | undefined;
                }[] | undefined;
                uses?: {
                    name?: string | undefined;
                    owner?: string | undefined;
                    typeName?: string | undefined;
                    versions?: string | undefined;
                }[] | undefined;
            } | undefined;
            buildInfo?: {
                created?: Date | undefined;
                dependencies?: {
                    [x: string]: string | undefined;
                } | undefined;
            } | undefined;
            assets?: {
                files?: {
                    path?: string | undefined;
                    content?: string | undefined;
                    isDirectory?: boolean | undefined;
                    isBase64?: boolean | undefined;
                }[] | undefined;
            } | undefined;
            assetIds?: {
                [x: string]: string | undefined;
            } | undefined;
        } & {
            code?: string | undefined;
            dependencies?: ({
                actor?: {
                    name?: string | undefined;
                    owner?: string | undefined;
                    version?: string | undefined;
                } | undefined;
                hostname?: string | undefined;
                provides?: {
                    actor?: {
                        name?: string | undefined;
                        owner?: string | undefined;
                        version?: string | undefined;
                    } | undefined;
                    definition?: {
                        fullName?: string | undefined;
                        methods?: {
                            fullName?: string | undefined;
                            name?: string | undefined;
                            requestStream?: boolean | undefined;
                            responseStream?: boolean | undefined;
                            requestType?: string | undefined;
                            responseType?: string | undefined;
                        }[] | undefined;
                        name?: string | undefined;
                        version?: string | undefined;
                    } | undefined;
                    locations?: {
                        allow?: string[] | undefined;
                        deny?: string[] | undefined;
                    } | undefined;
                    partitionsBy?: string[] | undefined;
                }[] | undefined;
                uses?: {
                    name?: string | undefined;
                    owner?: string | undefined;
                    typeName?: string | undefined;
                    versions?: string | undefined;
                }[] | undefined;
            } & {
                actor?: ({
                    name?: string | undefined;
                    owner?: string | undefined;
                    version?: string | undefined;
                } & {
                    name?: string | undefined;
                    owner?: string | undefined;
                    version?: string | undefined;
                } & { [K in Exclude<keyof I["bundle"]["dependencies"]["actor"], "$type" | keyof import("../../runtime/bundle.js").ActorSpec>]: never; }) | undefined;
                hostname?: string | undefined;
                provides?: ({
                    actor?: {
                        name?: string | undefined;
                        owner?: string | undefined;
                        version?: string | undefined;
                    } | undefined;
                    definition?: {
                        fullName?: string | undefined;
                        methods?: {
                            fullName?: string | undefined;
                            name?: string | undefined;
                            requestStream?: boolean | undefined;
                            responseStream?: boolean | undefined;
                            requestType?: string | undefined;
                            responseType?: string | undefined;
                        }[] | undefined;
                        name?: string | undefined;
                        version?: string | undefined;
                    } | undefined;
                    locations?: {
                        allow?: string[] | undefined;
                        deny?: string[] | undefined;
                    } | undefined;
                    partitionsBy?: string[] | undefined;
                }[] & ({
                    actor?: {
                        name?: string | undefined;
                        owner?: string | undefined;
                        version?: string | undefined;
                    } | undefined;
                    definition?: {
                        fullName?: string | undefined;
                        methods?: {
                            fullName?: string | undefined;
                            name?: string | undefined;
                            requestStream?: boolean | undefined;
                            responseStream?: boolean | undefined;
                            requestType?: string | undefined;
                            responseType?: string | undefined;
                        }[] | undefined;
                        name?: string | undefined;
                        version?: string | undefined;
                    } | undefined;
                    locations?: {
                        allow?: string[] | undefined;
                        deny?: string[] | undefined;
                    } | undefined;
                    partitionsBy?: string[] | undefined;
                } & {
                    actor?: ({
                        name?: string | undefined;
                        owner?: string | undefined;
                        version?: string | undefined;
                    } & {
                        name?: string | undefined;
                        owner?: string | undefined;
                        version?: string | undefined;
                    } & { [K_1 in Exclude<keyof I["bundle"]["dependencies"]["provides"][number]["actor"], "$type" | keyof import("../../runtime/bundle.js").ActorSpec>]: never; }) | undefined;
                    definition?: ({
                        fullName?: string | undefined;
                        methods?: {
                            fullName?: string | undefined;
                            name?: string | undefined;
                            requestStream?: boolean | undefined;
                            responseStream?: boolean | undefined;
                            requestType?: string | undefined;
                            responseType?: string | undefined;
                        }[] | undefined;
                        name?: string | undefined;
                        version?: string | undefined;
                    } & {
                        fullName?: string | undefined;
                        methods?: ({
                            fullName?: string | undefined;
                            name?: string | undefined;
                            requestStream?: boolean | undefined;
                            responseStream?: boolean | undefined;
                            requestType?: string | undefined;
                            responseType?: string | undefined;
                        }[] & ({
                            fullName?: string | undefined;
                            name?: string | undefined;
                            requestStream?: boolean | undefined;
                            responseStream?: boolean | undefined;
                            requestType?: string | undefined;
                            responseType?: string | undefined;
                        } & {
                            fullName?: string | undefined;
                            name?: string | undefined;
                            requestStream?: boolean | undefined;
                            responseStream?: boolean | undefined;
                            requestType?: string | undefined;
                            responseType?: string | undefined;
                        } & { [K_2 in Exclude<keyof I["bundle"]["dependencies"]["provides"][number]["definition"]["methods"][number], "$type" | keyof import("../../runtime/serializable.js").SerializableMethodDefinition>]: never; })[] & { [K_3 in Exclude<keyof I["bundle"]["dependencies"]["provides"][number]["definition"]["methods"], "$type" | keyof {
                            fullName?: string | undefined;
                            name?: string | undefined;
                            requestStream?: boolean | undefined;
                            responseStream?: boolean | undefined;
                            requestType?: string | undefined;
                            responseType?: string | undefined;
                        }[]>]: never; }) | undefined;
                        name?: string | undefined;
                        version?: string | undefined;
                    } & { [K_4 in Exclude<keyof I["bundle"]["dependencies"]["provides"][number]["definition"], "$type" | keyof import("../../runtime/serializable.js").SerializableServiceDefinition>]: never; }) | undefined;
                    locations?: ({
                        allow?: string[] | undefined;
                        deny?: string[] | undefined;
                    } & {
                        allow?: (string[] & string[] & { [K_5 in Exclude<keyof I["bundle"]["dependencies"]["provides"][number]["locations"]["allow"], "$type" | keyof string[]>]: never; }) | undefined;
                        deny?: (string[] & string[] & { [K_6 in Exclude<keyof I["bundle"]["dependencies"]["provides"][number]["locations"]["deny"], "$type" | keyof string[]>]: never; }) | undefined;
                    } & { [K_7 in Exclude<keyof I["bundle"]["dependencies"]["provides"][number]["locations"], "$type" | keyof import("../../runtime/bundle.js").LocationFilter>]: never; }) | undefined;
                    partitionsBy?: (string[] & string[] & { [K_8 in Exclude<keyof I["bundle"]["dependencies"]["provides"][number]["partitionsBy"], "$type" | keyof string[]>]: never; }) | undefined;
                } & { [K_9 in Exclude<keyof I["bundle"]["dependencies"]["provides"][number], "$type" | keyof import("../../runtime/bundle.js").PackageSpec>]: never; })[] & { [K_10 in Exclude<keyof I["bundle"]["dependencies"]["provides"], "$type" | keyof {
                    actor?: {
                        name?: string | undefined;
                        owner?: string | undefined;
                        version?: string | undefined;
                    } | undefined;
                    definition?: {
                        fullName?: string | undefined;
                        methods?: {
                            fullName?: string | undefined;
                            name?: string | undefined;
                            requestStream?: boolean | undefined;
                            responseStream?: boolean | undefined;
                            requestType?: string | undefined;
                            responseType?: string | undefined;
                        }[] | undefined;
                        name?: string | undefined;
                        version?: string | undefined;
                    } | undefined;
                    locations?: {
                        allow?: string[] | undefined;
                        deny?: string[] | undefined;
                    } | undefined;
                    partitionsBy?: string[] | undefined;
                }[]>]: never; }) | undefined;
                uses?: ({
                    name?: string | undefined;
                    owner?: string | undefined;
                    typeName?: string | undefined;
                    versions?: string | undefined;
                }[] & ({
                    name?: string | undefined;
                    owner?: string | undefined;
                    typeName?: string | undefined;
                    versions?: string | undefined;
                } & {
                    name?: string | undefined;
                    owner?: string | undefined;
                    typeName?: string | undefined;
                    versions?: string | undefined;
                } & { [K_11 in Exclude<keyof I["bundle"]["dependencies"]["uses"][number], "$type" | keyof PackageQuery>]: never; })[] & { [K_12 in Exclude<keyof I["bundle"]["dependencies"]["uses"], "$type" | keyof {
                    name?: string | undefined;
                    owner?: string | undefined;
                    typeName?: string | undefined;
                    versions?: string | undefined;
                }[]>]: never; }) | undefined;
            } & { [K_13 in Exclude<keyof I["bundle"]["dependencies"], "$type" | keyof import("../../runtime/bundle.js").DependencySpec>]: never; }) | undefined;
            buildInfo?: ({
                created?: Date | undefined;
                dependencies?: {
                    [x: string]: string | undefined;
                } | undefined;
            } & {
                created?: Date | undefined;
                dependencies?: ({
                    [x: string]: string | undefined;
                } & {
                    [x: string]: string | undefined;
                } & { [K_14 in Exclude<keyof I["bundle"]["buildInfo"]["dependencies"], string | number>]: never; }) | undefined;
            } & { [K_15 in Exclude<keyof I["bundle"]["buildInfo"], "$type" | keyof import("../../runtime/bundle.js").BuildInfo>]: never; }) | undefined;
            assets?: ({
                files?: {
                    path?: string | undefined;
                    content?: string | undefined;
                    isDirectory?: boolean | undefined;
                    isBase64?: boolean | undefined;
                }[] | undefined;
            } & {
                files?: ({
                    path?: string | undefined;
                    content?: string | undefined;
                    isDirectory?: boolean | undefined;
                    isBase64?: boolean | undefined;
                }[] & ({
                    path?: string | undefined;
                    content?: string | undefined;
                    isDirectory?: boolean | undefined;
                    isBase64?: boolean | undefined;
                } & {
                    path?: string | undefined;
                    content?: string | undefined;
                    isDirectory?: boolean | undefined;
                    isBase64?: boolean | undefined;
                } & { [K_16 in Exclude<keyof I["bundle"]["assets"]["files"][number], "$type" | keyof import("../buildpack/filesystem.js").File>]: never; })[] & { [K_17 in Exclude<keyof I["bundle"]["assets"]["files"], "$type" | keyof {
                    path?: string | undefined;
                    content?: string | undefined;
                    isDirectory?: boolean | undefined;
                    isBase64?: boolean | undefined;
                }[]>]: never; }) | undefined;
            } & { [K_18 in Exclude<keyof I["bundle"]["assets"], "$type" | "files">]: never; }) | undefined;
            assetIds?: ({
                [x: string]: string | undefined;
            } & {
                [x: string]: string | undefined;
            } & { [K_19 in Exclude<keyof I["bundle"]["assetIds"], string | number>]: never; }) | undefined;
        } & { [K_20 in Exclude<keyof I["bundle"], "$type" | keyof Bundle>]: never; }) | undefined;
        error?: ({
            query?: {
                name?: string | undefined;
                owner?: string | undefined;
                typeName?: string | undefined;
                versions?: string | undefined;
            } | undefined;
            text?: string | undefined;
        } & {
            query?: ({
                name?: string | undefined;
                owner?: string | undefined;
                typeName?: string | undefined;
                versions?: string | undefined;
            } & {
                name?: string | undefined;
                owner?: string | undefined;
                typeName?: string | undefined;
                versions?: string | undefined;
            } & { [K_21 in Exclude<keyof I["error"]["query"], "$type" | keyof PackageQuery>]: never; }) | undefined;
            text?: string | undefined;
        } & { [K_22 in Exclude<keyof I["error"], "$type" | keyof ResolutionError>]: never; }) | undefined;
        plugin?: ({
            provides?: {
                fullName?: string | undefined;
                methods?: {
                    fullName?: string | undefined;
                    name?: string | undefined;
                    requestStream?: boolean | undefined;
                    responseStream?: boolean | undefined;
                    requestType?: string | undefined;
                    responseType?: string | undefined;
                }[] | undefined;
                name?: string | undefined;
                version?: string | undefined;
            }[] | undefined;
            hostname?: string | undefined;
        } & {
            provides?: ({
                fullName?: string | undefined;
                methods?: {
                    fullName?: string | undefined;
                    name?: string | undefined;
                    requestStream?: boolean | undefined;
                    responseStream?: boolean | undefined;
                    requestType?: string | undefined;
                    responseType?: string | undefined;
                }[] | undefined;
                name?: string | undefined;
                version?: string | undefined;
            }[] & ({
                fullName?: string | undefined;
                methods?: {
                    fullName?: string | undefined;
                    name?: string | undefined;
                    requestStream?: boolean | undefined;
                    responseStream?: boolean | undefined;
                    requestType?: string | undefined;
                    responseType?: string | undefined;
                }[] | undefined;
                name?: string | undefined;
                version?: string | undefined;
            } & {
                fullName?: string | undefined;
                methods?: ({
                    fullName?: string | undefined;
                    name?: string | undefined;
                    requestStream?: boolean | undefined;
                    responseStream?: boolean | undefined;
                    requestType?: string | undefined;
                    responseType?: string | undefined;
                }[] & ({
                    fullName?: string | undefined;
                    name?: string | undefined;
                    requestStream?: boolean | undefined;
                    responseStream?: boolean | undefined;
                    requestType?: string | undefined;
                    responseType?: string | undefined;
                } & {
                    fullName?: string | undefined;
                    name?: string | undefined;
                    requestStream?: boolean | undefined;
                    responseStream?: boolean | undefined;
                    requestType?: string | undefined;
                    responseType?: string | undefined;
                } & { [K_23 in Exclude<keyof I["plugin"]["provides"][number]["methods"][number], "$type" | keyof import("../../runtime/serializable.js").SerializableMethodDefinition>]: never; })[] & { [K_24 in Exclude<keyof I["plugin"]["provides"][number]["methods"], "$type" | keyof {
                    fullName?: string | undefined;
                    name?: string | undefined;
                    requestStream?: boolean | undefined;
                    responseStream?: boolean | undefined;
                    requestType?: string | undefined;
                    responseType?: string | undefined;
                }[]>]: never; }) | undefined;
                name?: string | undefined;
                version?: string | undefined;
            } & { [K_25 in Exclude<keyof I["plugin"]["provides"][number], "$type" | keyof import("../../runtime/serializable.js").SerializableServiceDefinition>]: never; })[] & { [K_26 in Exclude<keyof I["plugin"]["provides"], "$type" | keyof {
                fullName?: string | undefined;
                methods?: {
                    fullName?: string | undefined;
                    name?: string | undefined;
                    requestStream?: boolean | undefined;
                    responseStream?: boolean | undefined;
                    requestType?: string | undefined;
                    responseType?: string | undefined;
                }[] | undefined;
                name?: string | undefined;
                version?: string | undefined;
            }[]>]: never; }) | undefined;
            hostname?: string | undefined;
        } & { [K_27 in Exclude<keyof I["plugin"], "$type" | keyof InspectorDescription>]: never; }) | undefined;
    } & { [K_28 in Exclude<keyof I, "$type" | keyof Resolution>]: never; }>(object: I): Resolution;
};
export declare const ResolutionError: {
    $type: "devvit.plugin.linker.ResolutionError";
    encode(message: ResolutionError, writer?: _m0.Writer): _m0.Writer;
    decode(input: _m0.Reader | Uint8Array, length?: number): ResolutionError;
    fromJSON(object: any): ResolutionError;
    toJSON(message: ResolutionError): unknown;
    fromPartial<I extends {
        query?: {
            name?: string | undefined;
            owner?: string | undefined;
            typeName?: string | undefined;
            versions?: string | undefined;
        } | undefined;
        text?: string | undefined;
    } & {
        query?: ({
            name?: string | undefined;
            owner?: string | undefined;
            typeName?: string | undefined;
            versions?: string | undefined;
        } & {
            name?: string | undefined;
            owner?: string | undefined;
            typeName?: string | undefined;
            versions?: string | undefined;
        } & { [K in Exclude<keyof I["query"], "$type" | keyof PackageQuery>]: never; }) | undefined;
        text?: string | undefined;
    } & { [K_1 in Exclude<keyof I, "$type" | keyof ResolutionError>]: never; }>(object: I): ResolutionError;
};
/**
 * A Resolver tells the Linker what bundles exist, and helps the Linker know
 * which bundle is the best bundle to match a given request or PackageQuery.
 */
export interface Resolver {
    /** What plugins are available to the Resolver? */
    RegisterPlugins(request: InspectorDescriptions, metadata?: Metadata): Promise<Empty>;
    /** What Bundle is best to satisfy the given request? */
    Resolve(request: PackageQuery, metadata?: Metadata): Promise<Resolution>;
    /** Notify the resolver that a bundle exists. Newer Bundles can overwrite older bundles. */
    RegisterBundle(request: Bundle, metadata?: Metadata): Promise<Empty>;
}
export declare class ResolverClientImpl implements Resolver {
    private readonly rpc;
    private readonly service;
    constructor(rpc: Rpc, opts?: {
        service?: string;
    });
    RegisterPlugins(request: InspectorDescriptions): Promise<Empty>;
    Resolve(request: PackageQuery): Promise<Resolution>;
    RegisterBundle(request: Bundle): Promise<Empty>;
}
/**
 * A Resolver tells the Linker what bundles exist, and helps the Linker know
 * which bundle is the best bundle to match a given request or PackageQuery.
 */
export type ResolverDefinition = typeof ResolverDefinition;
export declare const ResolverDefinition: {
    name: 'Resolver';
    fullName: string;
    methods: {
        [methodName: string]: MethodDefinition & {
            options: {};
        };
    };
};
interface Rpc {
    request(service: string, method: string, data: Uint8Array): Promise<Uint8Array>;
}
export {};
//# sourceMappingURL=resolver.d.ts.map