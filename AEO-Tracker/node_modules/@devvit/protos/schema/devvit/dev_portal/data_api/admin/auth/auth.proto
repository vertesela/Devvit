syntax = "proto3";

package devvit.dev_portal.data_api.admin.auth;

import "devvit/data/api/v1alpha/admin.proto";
import "google/protobuf/duration.proto";
import "google/protobuf/timestamp.proto";

option go_package = "github.snooguts.net/reddit/reddit-devplatform-monorepo/go-common/generated/protos/types/devvit/devportal/data_api/admin/auth";

message CreateDataTokenRequest {
  string organization_name = 1;
  google.protobuf.Duration expires_in = 2;
}

message CreateDataTokenResponse {
  string token = 1;
  google.protobuf.Timestamp expires_at = 2;
}

message GetDataTokenByIdRequest {
  string id = 1;
}

message GetDataTokenByIdResponse {
  devvit.data.api.v1alpha.DataToken token = 1;
}

message GetDataTokensByOrganizationNameRequest {
  string organization_name = 1;
}

message GetDataTokensByOrganizationNameResponse {
  repeated devvit.data.api.v1alpha.DataToken tokens = 1;
}

message RevokeDataTokenByIdRequest {
  string token_id = 1;
}

message RevokeDataTokenByIdResponse {}
