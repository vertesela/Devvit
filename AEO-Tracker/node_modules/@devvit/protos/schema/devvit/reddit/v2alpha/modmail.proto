syntax = "proto3";

package devvit.reddit.v2alpha;

import "devvit/options/options.proto";
import "devvit/reddit/v2alpha/subredditv2.proto";
import "devvit/reddit/v2alpha/userv2.proto";
import "google/protobuf/timestamp.proto";

option go_package = "github.snooguts.net/reddit/reddit-devplatform-monorepo/go-common/generated/protos/types/devvit/reddit/v2alpha";
option java_package = "com.reddit.devvit.reddit.v2alpha";

message ModMail {
  option (devvit.options.trigger) = {
    source: "modmail"
    action: "send"
    noun: "message"
  };

  // author of the message
  devvit.reddit.v2alpha.UserV2 message_author = 1 [(devvit.options.v2_event_path) = "modmail_message.author_id"];

  // message creation timestamp
  google.protobuf.Timestamp created_at = 2 [(devvit.options.v2_event_path) = "modmail_message.date_timestamp"];

  // what type of user is the message author participating as:
  // moderator - as a mod of the owning subreddit
  // participant_user - as a non-mod user
  // participant_sr - as a mod of the participant subreddit (see conversation_type field)
  string message_author_type = 4 [(devvit.options.v2_event_path) = "modmail_message.participating_as"];

  // state of the conversation: new, in-progress, archived
  string conversation_state = 6 [(devvit.options.v2_event_path) = "modmail_conversation.state"];

  // type of conversation: internal (mod discussion), sr_user (between a subreddit and user), sr_sr (between two subreddits)
  string conversation_type = 7 [(devvit.options.v2_event_path) = "modmail_conversation.type"];

  // is the conversation auto generated? (from automod, u/reddit etc)
  bool is_auto_generated = 8 [(devvit.options.v2_event_path) = "modmail_conversation.is_auto"];

  // subreddit owning the modmail conversation
  devvit.reddit.v2alpha.SubredditV2 conversation_subreddit = 9 [(devvit.options.v2_event_path) = "modmail_conversation.subreddit_id"];

  // the subreddit that the modmail is sent to or nil
  devvit.reddit.v2alpha.SubredditV2 destination_subreddit = 12 [(devvit.options.v2_event_path) = "modmail_conversation.participant_subreddit_id"];

  // Conversation ID (base36 encoded string, does not have a thing-type prefix)
  string conversation_id = 10 [(devvit.options.v2_event_path) = "modmail_conversation.id"];

  // Message ID (base36 encoded string, does not have a thing-type prefix)
  string message_id = 11 [(devvit.options.v2_event_path) = "modmail_message.id"];

  // Deprecated - message_body and conversation_subject. PII
  reserved 3, 5;
  reserved "message_body", "conversation_subject";
}
