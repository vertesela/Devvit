syntax = "proto3";

package devvit.reddit.post_guidance.v1alpha;

import "google/protobuf/wrappers.proto";

option go_package = "github.snooguts.net/reddit/reddit-devplatform-monorepo/go-common/generated/protos/types/devvit/reddit/post_guidance/v1alpha";
option java_package = "com.reddit.devvit.reddit.post_guidance.v1alpha";

// This file is a direct port from
// https://github.snooguts.net/reddit/reddit-service-post/blob/master/post/post.thrift

service PostGuidance {
  rpc GetPostGuidance(ValidatePostRequirementsRequest) returns (ValidatePostRequirementsResponse) {}
}

enum DiscussionType {
  NULL_VALUE = 0;
  CHAT = 1;
}

enum PostType {
  UNKNOWN = 0;
  LINK = 1;
  TEXT = 2;
  LINK_TEXT = 3;
  MEDIA_UPLOAD = 4;
  POLL = 5;
  CROSSPOST = 6;
  GALLERY = 7;
  IMAGE = 9;
  VIDEO = 10;
}

enum MediaType {
  MEDIA_UNKNOWN = 0;
  MEDIA_IMAGE = 1;
  MEDIA_VIDEO = 2;
  MEDIA_VIDEOGIF = 3;
  MEDIA_STREAMING = 4;
}

message PostContent {
  google.protobuf.StringValue url = 1;
  google.protobuf.StringValue body = 2;
  google.protobuf.BoolValue is_rtjson = 3;
  google.protobuf.StringValue crosspost_link_id = 4;
  MediaType media_type = 5;
  google.protobuf.BoolValue is_user_upload = 6;
  repeated GalleryItem gallery_items = 7;
}

message PostMetadata {
  google.protobuf.StringValue title = 1;
  google.protobuf.StringValue subreddit_id = 2;
  google.protobuf.StringValue user_id = 3;
  PostType post_type = 4;
  google.protobuf.BoolValue is_locked = 5;
  google.protobuf.BoolValue is_nsfw = 6;
  google.protobuf.BoolValue is_original_content = 7;
  google.protobuf.BoolValue is_receiving_replies = 8;
  google.protobuf.BoolValue is_spoiler = 9;
  google.protobuf.BoolValue is_unlisted = 10;
  google.protobuf.StringValue flair_id = 11;
  google.protobuf.StringValue flair_text = 12;
  google.protobuf.Int64Value event_start = 13;
  google.protobuf.Int64Value event_end = 14;
  DiscussionType discussion_type = 15;
  google.protobuf.StringValue collection_id = 16;
  google.protobuf.StringValue ip = 17;
  google.protobuf.BoolValue is_promoted = 18;
}

message GalleryItem {
  google.protobuf.StringValue id = 1;
  google.protobuf.StringValue media_id = 2;
  google.protobuf.StringValue caption = 3;
  google.protobuf.StringValue outbound_url = 4;
  google.protobuf.BoolValue is_deleted = 5;
  google.protobuf.StringValue call_to_action = 6;
  google.protobuf.StringValue display_url = 7;
  Product product = 8;
}

message Product {
  google.protobuf.StringValue title = 1;
  google.protobuf.StringValue price = 2;
  google.protobuf.StringValue description = 3;
}

message ValidatePostRequirementsRequest {
  PostContent post_content = 1;
  PostMetadata post_metadata = 2;
}

message ValidationError {
  google.protobuf.StringValue reason = 1;
  google.protobuf.StringValue field = 2;
  google.protobuf.StringValue short_name = 3;
}

message ValidatePostRequirementsResponse {
  repeated ValidationError errors = 1;
}
