syntax = "proto3";

package devvit.plugin.automodregex;

option go_package = "github.snooguts.net/reddit/reddit-devplatform-monorepo/go-common/generated/protos/types/devvit/plugin/automodregex";
option java_outer_classname = "_AutomodRegex";
option java_package = "com.reddit.devvit.plugin.automodregex";

message AutomodRegexInput {
  string pattern = 1;
  string input = 2;
  bool case_insensitive = 3;
}

message AutomodRegexMatchOutput {
  repeated string groups = 1;
}

message AutomodRegexTestOutput {
  bool match = 1;
}

// This interface is for regex evaluation for Automod
// There are special cases in Automod regexes that JS can't
// handle, so we execute them in golang instead.
//
// NOTE: These methods do attempt to emulate full regex
// functionality. It is only fulfilling the cases required by Automod
service AutomodRegex {
  rpc AutomodRegexMatch(AutomodRegexInput) returns (AutomodRegexMatchOutput);
  rpc AutomodRegexTest(AutomodRegexInput) returns (AutomodRegexTestOutput);
}
